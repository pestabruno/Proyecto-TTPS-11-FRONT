<div class="detalle-container">
  
  <!-- Bot√≥n volver -->
  <button class="btn-volver" (click)="volver()">
    ‚Üê Volver al listado
  </button>

  <!-- Loading -->
  <div *ngIf="cargando" class="mensaje-carga">
    <p>Cargando publicaci√≥n...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !cargando" class="mensaje-error">
    <p>{{ error }}</p>
    <button (click)="volver()">Volver al listado</button>
  </div>

  <!-- Contenido de la publicaci√≥n -->
  <div *ngIf="publicacion && !cargando" class="detalle-content">
    
    <!-- Encabezado -->
    <div class="detalle-header">
      <h1>{{ publicacion.nombre }}</h1>
      <span class="estado-badge" [ngClass]="'estado-' + publicacion.estado">
        {{ publicacion.estado }}
      </span>
    </div>

    <!-- Im√°genes -->
    <div class="imagenes-galeria" *ngIf="publicacion.imagenes64 && publicacion.imagenes64.length > 0">
      <img [src]="publicacion.imagenes64[0]" [alt]="publicacion.nombre" class="imagen-principal">
    </div>
    <div *ngIf="!publicacion.imagenes64 || publicacion.imagenes64.length === 0" class="sin-imagen-detalle">
      <p>Sin imagen disponible</p>
    </div>

    <!-- Informaci√≥n principal -->
    <div class="info-grid">
      <div class="info-card">
        <h3>Informaci√≥n de la mascota</h3>
        <p><strong>Color:</strong> {{ publicacion.color }}</p>
        <p><strong>Tama√±o:</strong> {{ publicacion.tamanio || 'No especificado' }}</p>
        <p><strong>Fecha:</strong> {{ publicacion.fecha }}</p>
        <p><strong>Descripci√≥n:</strong> {{ publicacion.descripcion }}</p>
      </div>

      <div class="info-card">
        <h3>Ubicaci√≥n</h3>
        <p><strong>Provincia:</strong> {{ publicacion.provincia }}</p>
        <p><strong>Localidad:</strong> {{ publicacion.localidad }}</p>
        <p><strong>Calle:</strong> {{ publicacion.calle }} {{ publicacion.altura }}</p>
      </div>

      <div class="info-card" *ngIf="publicacion.autor">
        <h3>Contacto</h3>
        <p><strong>Nombre:</strong> {{ publicacion.autor.nombre }} {{ publicacion.autor.apellido }}</p>
        <p><strong>Tel√©fono:</strong> {{ publicacion.telefono }}</p>
        <p><strong>Email:</strong> {{ publicacion.autor.email }}</p>
      </div>
    </div>

    <!-- Bot√≥n de acci√≥n principal -->
    <div class="acciones-container">
      <button class="btn-accion btn-avistamiento" (click)="agregarAvistamiento()">
        Reportar un avistamiento
      </button>
    </div>

    <!-- Acciones del autor (solo visible si es el due√±o) -->
    <div *ngIf="esAutor" class="acciones-autor">
      <h3>Administrar publicaci√≥n</h3>
      <div class="botones-autor">
        <button class="btn-accion btn-editar" (click)="editarPublicacion()">
           Editar
        </button>
        <button 
          class="btn-accion btn-eliminar" 
          (click)="eliminarPublicacion()"
          [disabled]="eliminando">
          {{ eliminando ? ' Eliminando...' : 'Eliminar' }}
        </button>
      </div>
    </div>

    <!-- Secci√≥n de avistamientos -->
    <div class="avistamientos-section" *ngIf="publicacion.avistamientos && publicacion.avistamientos.length > 0">
      <h3>Avistamientos reportados ({{ publicacion.avistamientos.length }})</h3>
      <div class="avistamiento-card" *ngFor="let avistamiento of publicacion.avistamientos">
        <p><strong>Fecha:</strong> {{ avistamiento.fecha }}</p>
        <p><strong>Descripci√≥n:</strong> {{ avistamiento.descripcion || 'Sin descripci√≥n' }}</p>
      </div>
    </div>

    <div *ngIf="!publicacion.avistamientos || publicacion.avistamientos.length === 0" class="sin-avistamientos">
      <p>A√∫n no hay avistamientos reportados para esta mascota</p>
    </div>

  </div>
</div>



<!-- MODAL DE EDITAR (agregar al final del archivo) -->
<div class="modal-overlay" *ngIf="mostrarModalEditar">
  <div class="modal-content">
    <button class="cerrar-modal" (click)="cerrarModalEditar()">√ó</button>
    <h2>Editar publicaci√≥n</h2>
    
    <div class="form-group">
      <label>Nombre</label>
      <input type="text" [(ngModel)]="publicacionEditada.nombre" />
    </div>

    <div class="form-group">
      <label>Color</label>
      <input type="text" [(ngModel)]="publicacionEditada.color" />
    </div>

    <div class="form-group">
      <label>Tama√±o</label>
      <input type="text" [(ngModel)]="publicacionEditada.tamanio" />
    </div>

    <div class="form-group">
      <label>Descripci√≥n</label>
      <textarea [(ngModel)]="publicacionEditada.descripcion" rows="3"></textarea>
    </div>

    <div class="form-group">
      <label>Tel√©fono</label>
      <input type="text" [(ngModel)]="publicacionEditada.telefono" />
    </div>

    <div class="form-group">
      <label>Provincia</label>
      <input type="text" [(ngModel)]="publicacionEditada.provincia" />
    </div>

    <div class="form-group">
      <label>Localidad</label>
      <input type="text" [(ngModel)]="publicacionEditada.localidad" />
    </div>

    <div class="form-group">
      <label>Calle</label>
      <input type="number" [(ngModel)]="publicacionEditada.calle" />
    </div>

    <div class="form-group">
      <label>Altura</label>
      <input type="number" [(ngModel)]="publicacionEditada.altura" />
    </div>

    <div class="modal-botones">
      <button class="btn-guardar" (click)="guardarEdicion()" [disabled]="guardando">
        {{ guardando ? '‚è≥ Guardando...' : 'üíæ Guardar' }}
      </button>
      <button class="btn-cancelar" (click)="cerrarModalEditar()">Cancelar</button>
    </div>
  </div>
</div>